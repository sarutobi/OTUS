## Цель:
- создавать дополнительный диск для уже существующей виртуальной машины, размечать его и делать на нем файловую систему
- переносить содержимое базы данных PostgreSQL на дополнительный диск
- переносить содержимое БД PostgreSQL между виртуальными машинами
- установить PostgreSQL в Docker контейнере
- настроить контейнер для внешнего подключения
### 1 вариант:
- создайте виртуальную машину c Ubuntu 20.04 LTS (bionic) в GCE типа e2-medium в default VPC в любом регионе и зоне, например us-central1-a
- поставьте на нее PostgreSQL через sudo apt
- проверьте что кластер запущен через sudo -u postgres pg_lsclusters
- зайдите из под пользователя postgres в psql и сделайте произвольную таблицу с произвольным содержимым

    postgres=# create table test(c1 text);
    postgres=# insert into test values('1');
    \q

- остановите postgres например через sudo -u postgres pg_ctlcluster 13 main stop
- создайте новый standard persistent диск GKE через Compute Engine -> Disks в том же регионе и зоне что GCE инстанс размером например 10GB
- добавьте свеже-созданный диск к виртуальной машине - надо зайти в режим ее редактирования и дальше выбрать пункт attach existing disk
- проинициализируйте диск согласно инструкции и подмонтировать файловую систему, только не забывайте менять имя диска на актуальное, в вашем случае это скорее всего будет /dev/sdb - https://www.digitalocean.com/community/tutorials/how-to-partition-and-format-storage-devices-in-linux
- сделайте пользователя postgres владельцем /mnt/data - chown -R postgres:postgres /mnt/data/
- перенесите содержимое /var/lib/postgres/13 в /mnt/data - mv /var/lib/postgresql/13 /mnt/data
- попытайтесь запустить кластер - sudo -u postgres pg_ctlcluster 13 main start
- напишите получилось или нет и почему
> кластер не запустился, отсутствует или недоступна директория базы данных
- задание: найти конфигурационный параметр в файлах раположенных в /etc/postgresql/13/main который надо поменять и поменяйте его
- напишите что и почему поменяли
> в конфигурационном файле /etc/postgresql/12/main/postgresql.conf изменен параметр data_directory на /mnt/data/13/main 
- попытайтесь запустить кластер - sudo -u postgres pg_ctlcluster 13 main start
- напишите получилось или нет и почему
> после изменения конфигурационного файла кластер запустился, так как была успешно найдена директория с данными.
- зайдите через через psql и проверьте содержимое ранее созданной таблицы
> данные в созданной таблице присутствуют
- задание со звездочкой: не удаляя существующий GCE инстанс сделайте новый, поставьте на его PostgreSQL, удалите файлы с данными из /var/lib/postgres, перемонтируйте внешний диск который сделали ранее от первой виртуальной машины ко второй и запустите PostgreSQL на второй машине так чтобы он работал с данными на внешнем диске, расскажите как вы это сделали и что в итоге получилось.
> Диск с имеющимися данными подключен к новой виртуальной машине, смонтирован в директорию /var/lib/postgres, после этого кластер запущен, созданные таблицы и данные в них присутсвуют на новом сервере. Для полноценной работы нужно прописать диск в таблицу /etc/mtab 

###2 вариант:
- сделать в GCE инстанс с Ubuntu 20.04
- поставить на нем Docker Engine
- сделать каталог /var/lib/postgres
- развернуть контейнер с PostgreSQL 13 смонтировав в него /var/lib/postgres
- развернуть контейнер с клиентом postgres
- подключится из контейнера с клиентом к контейнеру с сервером и сделать таблицу с парой строк
- подключится к контейнеру с сервером с ноутбука
- удалить контейнер с сервером
- создать его заново
- подключится снова из контейнера с клиентом к контейнеру с сервером
- проверить, что данные остались на месте
> Выполнено, данные остались.
